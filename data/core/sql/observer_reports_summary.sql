SELECT dt_observer_reports.ID AS report_id, dt_fishing_trip.REG_VESSEL_ID AS vessel_id, dt_observer_report_vessel_information.VESSEL_NAME AS vessel_name, dt_observer_reports.OBSERVER_FULL_NAME AS observer_name, dt_observer_reports.OBSERVATION_PERIOD_START AS observation_start, dt_observer_reports.OBSERVATION_PERIOD_END AS observation_end, dt_observer_reports.BOARDING_DATE AS embarkation_start, dt_observer_reports.DISEMBARK_DATE AS embarkation_end, dt_fishing_trip.DATE_FROM AS trip_start, dt_fishing_trip.DATE_TO AS trip_end, DATEDIFF(dt_observer_reports.DISEMBARK_DATE, dt_observer_reports.BOARDING_DATE) AS days_at_sea, COUNT(DISTINCT dt_fishing_activities.ID) AS nb_fishing_operations, CASE WHEN EXISTS (SELECT 1 FROM dt_fishing_trip ft2 WHERE ft2.REG_VESSEL_ID = dt_fishing_trip.REG_VESSEL_ID AND ft2.DATE_FROM = dt_fishing_trip.DATE_FROM AND ft2.DATE_TO = dt_fishing_trip.DATE_TO AND ft2.CL_FISH_FISHING_TRIP_TYPE_ID = 1) THEN 1 ELSE 0 END AS logbook_linked, CASE WHEN dt_length_frequencies.DT_FISHING_TRIP_ID IS NOT NULL THEN 1 ELSE 0 END AS biological_present, SUM(dt_fishing_activities_species.CATCH_QUANTITY_LIVE_WEIGHT_EQUIVALENT) AS total_catch, SUM(dt_fishing_activities_species.DISCARD_QUANTITY) AS total_discard FROM dt_observer_reports LEFT JOIN dt_fishing_trip ON dt_fishing_trip.ID = dt_observer_reports.DT_FISHING_TRIP_ID LEFT JOIN dt_observer_report_vessel_information ON dt_observer_report_vessel_information.DT_OBSERVER_REPORT_ID = dt_observer_reports.ID LEFT JOIN dt_fishing_activities ON dt_fishing_activities.DT_FISHING_TRIP_ID = dt_fishing_trip.ID LEFT JOIN dt_fishing_activities_species ON dt_fishing_activities_species.DT_FISHING_ACTIVITY_ID = dt_fishing_activities.ID LEFT JOIN dt_length_frequencies ON dt_length_frequencies.DT_FISHING_TRIP_ID = dt_observer_reports.DT_FISHING_TRIP_ID GROUP BY dt_observer_reports.ID, dt_fishing_trip.REG_VESSEL_ID, dt_observer_report_vessel_information.VESSEL_NAME, dt_observer_reports.OBSERVER_FULL_NAME, dt_observer_reports.OBSERVATION_PERIOD_START, dt_observer_reports.OBSERVATION_PERIOD_END, dt_observer_reports.BOARDING_DATE, dt_observer_reports.DISEMBARK_DATE, dt_fishing_trip.DATE_FROM, dt_fishing_trip.DATE_TO;